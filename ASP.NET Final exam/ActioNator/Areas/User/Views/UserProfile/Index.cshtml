@model FinalExamUI.ViewModels.UserProfile.ProfileViewModel
@{
    ViewData["Title"] = $"{Model.FullName} - Profile";
}

<div class="profile-container">
    <!-- Cover Photo and Profile Header -->
    <div class="relative">
        <div id="coverPhotoHeader" class="h-80 bg-cover bg-center" style="background-image: url('@Model.CoverPhotoUrl')">
            <!-- Cover Photo -->
        </div>
        
        <div class="absolute bottom-0 left-8 transform translate-y-1/2">
    <!-- Profile Picture -->
        <button type="button" onclick="openEditModal()" class="p-0 border-0 bg-transparent" title="Change profile picture">
            <img id="profileHeaderImage" src="@Model.ProfilePictureUrl" alt="@Model.FullName" class="w-40 h-40 rounded-full border-4 border-white shadow-lg cursor-pointer">
        </button>
    </div>
</div>
    
    <!-- Profile Info -->
    <div class="pt-24 pb-4 px-8 bg-white">
        <div class="flex flex-col md:flex-row md:items-end md:justify-between">
            <div class="text-center md:text-left md:ml-48">
                <div class="flex items-center gap-2 justify-center md:justify-start">
                    <h1 id="profileFullName" class="text-3xl font-bold">@Model.FullName</h1>
                    @if (Model.IsVerifiedCoach)
                    {
                        <span class="inline-flex items-center gap-1 text-xs font-semibold bg-green-100 text-green-700 px-2 py-1 rounded-full" title="Verified Coach">
                            <i class="fas fa-check-circle"></i>
                            Verified
                        </span>
                    }
                </div>
                <p id="profileHeadline" class="text-gray-600 mt-1">@Model.Headline</p>

            </div>
            
            <div class="flex gap-2 mt-4 md:mt-0 justify-center md:justify-end">
                @if (Model.IsCurrentUser)
                {
                    <button onclick="openEditModal()" class="bg-blue-500 text-white px-4 py-2 rounded-lg font-semibold hover:bg-blue-600 transition-colors" id="editProfileBtn">
                        <i class="fas fa-edit mr-2"></i>Edit Profile
                    </button>
                }
            </div>
        </div>
    </div>
    
    <!-- Navigation Tabs -->
    <div class="sticky top-0 z-10 bg-white border-b border-gray-200">
        <div class="px-8">
            <nav class="flex justify-center space-x-8 overflow-x-auto">
                <a href="#about" 
                   class="tab-link py-4 px-1 border-b-2 border-blue-500 text-blue-600 border-t-0 border-l-0 border-r-0 focus:outline-none focus:ring-0"
                   data-tab="About">
                    About
                </a>
                <a href="#posts" 
                   class="tab-link py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 border-t-0 border-l-0 border-r-0 focus:outline-none focus:ring-0"
                   data-tab="Posts">
                    Posts
                </a>
            </nav>
        </div>
    </div>
    
    <!-- Tab Content -->
    <div class="max-w-7xl mx-auto p-4">
        <!-- Posts Tab -->
        <div id="posts-tab" class="tab-content hidden">
    <div class="bg-white rounded-lg shadow p-8 text-center">
        <h3 class="text-xl font-semibold text-gray-700">No posts sended yet!</h3>
    </div>
</div>
        <!-- About Tab -->
        <div id="about-tab" class="tab-content block">
            <div id="aboutContainer">
                @await Html.PartialAsync("_AboutPartial", Model.AboutText ?? string.Empty)
            </div>
        </div>
    </div>
</div>

<!-- Include the edit profile modal -->
<partial name="_EditProfileModal" model="Model" />

<!-- Include Font Awesome for icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

<script>
    function openEditModal() {
        document.getElementById('editProfileModal').classList.remove('hidden');
        document.body.classList.add('overflow-hidden');
    }
    function closeEditModal() {
        document.getElementById('editProfileModal').classList.add('hidden');
        document.body.classList.remove('overflow-hidden');
    }
</script>

@section Scripts {
    <script>
        // Tab switching functionality
        document.addEventListener('DOMContentLoaded', function() {
            const links = document.querySelectorAll('.tab-link');
            const tabs = {
                Posts: document.getElementById('posts-tab'),
                About: document.getElementById('about-tab')
            };
            function activate(tab) {
                Object.keys(tabs).forEach(k => {
                    if (tabs[k]) tabs[k].classList.toggle('hidden', k !== tab);
                });
                links.forEach(a => {
                    const isActive = a.getAttribute('data-tab') === tab;
                    a.classList.toggle('border-blue-500', isActive);
                    a.classList.toggle('text-blue-600', isActive);
                    a.classList.toggle('border-transparent', !isActive);
                    a.classList.toggle('text-gray-500', !isActive);
                });
            }
            links.forEach(a => {
                a.addEventListener('click', function(e) {
                    e.preventDefault();
                    const tab = this.getAttribute('data-tab');
                    activate(tab);
                });
            });
            // Default to About tab on load
            activate('About');
        });
    </script>
}
